# Задача 3: Админка + База данных MongoDB

После этой задачи у тебя будет:
- Админка для редактирования контента сайта
- База данных MongoDB Atlas (бесплатная)
- Данные хранятся в облаке, а не в коде

---

## Часть 1: Регистрация в MongoDB Atlas

### Шаг 1.1: Создай аккаунт

1. Открой https://www.mongodb.com/atlas
2. Нажми **"Try Free"**
3. Зарегистрируйся (можно через Google)

---

### Шаг 1.2: Создай кластер (бесплатный)

1. Выбери **"Create a cluster"**
2. Выбери **FREE tier** (M0 Sandbox) — это бесплатно!
3. Выбери регион ближе к тебе (например Europe)
4. Нажми **"Create Cluster"**
5. Подожди 1-3 минуты пока создаётся

---

### Шаг 1.3: Создай пользователя базы данных

1. Слева нажми **"Database Access"**
2. Нажми **"Add New Database User"**
3. Выбери **"Password"**
4. Придумай username и password (запиши их!)
5. Database User Privileges: **"Read and write to any database"**
6. Нажми **"Add User"**

⚠️ **Запиши username и password — они понадобятся!**

---

### Шаг 1.4: Разреши доступ с любого IP

1. Слева нажми **"Network Access"**
2. Нажми **"Add IP Address"**
3. Нажми **"Allow Access from Anywhere"** (добавит 0.0.0.0/0)
4. Нажми **"Confirm"**

---

### Шаг 1.5: Получи строку подключения

1. Слева нажми **"Database"**
2. Нажми **"Connect"** рядом с твоим кластером
3. Выбери **"Connect your application"**
4. Скопируй строку подключения (выглядит как):
   ```
   mongodb+srv://USERNAME:PASSWORD@cluster0.xxxxx.mongodb.net/?retryWrites=true&w=majority
   ```
5. Замени `USERNAME` и `PASSWORD` на свои реальные данные

⚠️ **Сохрани эту строку — это твой MONGODB_URI!**

---

## Часть 2: Подключи базу к проекту

### Шаг 2.1: Перейди в проект

```bash
cd /c/projects/nha-trang/visa
```

### Шаг 2.2: Запусти Claude Code

```bash
claude
```

### Шаг 2.3: Попроси Claude подключить MongoDB

Скопируй и отправь:

```
У меня есть визовый сайт на Next.js.

Я зарегистрировался в MongoDB Atlas и получил строку подключения.
(строка подключения в .env.local)

Помоги мне:

1. Создать файл .env.local для хранения строки подключения
2. Установить нужные пакеты (mongoose или mongodb)
3. Создать подключение к базе данных
4. Создать модель для хранения информации о визах:
   - title (название секции)
   - content (текст)
   - order (порядок отображения)
   - isActive (показывать или нет)

Объясняй что делаешь простыми словами.
```

---

## Часть 3: Создай админку

### Шаг 3.1: Попроси Claude создать админку

```
Теперь создай простую админку для редактирования контента.

Требования:
1. Страница /admin (защищённая простым паролем)
2. Список всех секций из базы данных
3. Возможность редактировать текст каждой секции
4. Возможность менять порядок секций
5. Возможность включать/выключать секции
6. Кнопка "Сохранить" которая сохраняет в MongoDB

Дизайн:
- Простой и понятный
- Можно использовать базовые стили

Пароль для входа в админку пусть хранится в .env.local
```

---

## Часть 4: Перенеси контент в базу

### Шаг 4.1: Попроси Claude мигрировать данные

```
Сейчас контент про визы захардкожен в коде.

Помоги:
1. Создать скрипт который добавит текущий контент в MongoDB
2. Изменить главную страницу чтобы она брала данные из базы
3. После этого контент можно будет редактировать через админку
```

---

## Часть 5: Проверь что всё работает

### Шаг 5.1: Запусти сайт

```bash
npm run dev
```

### Шаг 5.2: Проверь

1. Открой http://localhost:3000 — сайт работает?
2. Открой http://localhost:3000/admin — админка открывается?
3. Попробуй изменить текст и сохранить
4. Обнови главную страницу — изменения появились?

---

## Часть 6: Задеплой на Vercel

### Шаг 6.1: Добавь переменные окружения в Vercel

1. Открой свой проект на https://vercel.com
2. Settings → Environment Variables
3. Добавь:
   - `MONGODB_URI` = твоя строка подключения
   - `ADMIN_PASSWORD` = пароль для админки

### Шаг 6.2: Передеплой

```
Помоги передеплоить сайт на Vercel с новыми изменениями
```

---

## Часть 7: Сохрани изменения

```bash
cd /c/projects/nha-trang
git add .
git commit -m "Add admin panel and MongoDB integration"
git push
```

⚠️ **Важно:** Файл `.env.local` НЕ должен попасть в git! Проверь что он в `.gitignore`.

---

## ✅ Чеклист

- [ ] MongoDB Atlas аккаунт создан
- [ ] Кластер создан (бесплатный M0)
- [ ] Пользователь базы данных создан
- [ ] Network Access настроен (0.0.0.0/0)
- [ ] Строка подключения получена
- [ ] База подключена к проекту
- [ ] Модель данных создана
- [ ] Админка работает на /admin
- [ ] Контент редактируется и сохраняется
- [ ] Главная страница берёт данные из базы
- [ ] Vercel настроен с переменными окружения
- [ ] Сайт работает в продакшене

---

## Что ты узнал

- Как работать с MongoDB Atlas
- Что такое база данных и зачем она нужна
- Как хранить секреты в .env файлах
- Как создать простую админку
- Как деплоить с переменными окружения

---

## Проблемы?

### Ошибка подключения к MongoDB
- Проверь что пароль в строке подключения правильный
- Проверь Network Access (должен быть 0.0.0.0/0)

### Админка не открывается
- Проверь что создал страницу /admin
- Проверь консоль браузера на ошибки

### Данные не сохраняются
- Проверь подключение к базе
- Посмотри логи в терминале
